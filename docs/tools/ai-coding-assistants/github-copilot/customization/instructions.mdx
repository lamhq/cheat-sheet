# Custom instructions

## Introduction

Custom instructions enable you to define common guidelines and rules that influence how AI generates code and performs tasks.

They are specified in Markdown files.

You can configure custom instructions to apply automatically to all chat requests or to specific files only.

You can manually attach custom instructions to a specific chat prompt.


## Use cases

- Make generated code follows your standards, coding practices, preferred technologies, or project requirements
- Provide guidelines for generating commit message, pull request title and description
- Set rules for code reviews: checking for security vulnerabilities, performance issues, or adherence to coding standards


## Types of instructions files

If you have multiple types of instructions files in your project, VS Code combines and adds them to the chat context.

VS Code supports multiple types of Markdown-based instructions files:

1. A single `.github/copilot-instructions.md` file:
   - Automatically applies to all chat requests in the workspace
   - Stored within the workspace
   - Enabled by the `github.copilot.chat.codeGeneration.useInstructionFiles` setting

2. One or more `[name].instructions.md` files:
   - Used when creating or modifying files
   - Conditionally applied using glob patterns
   - Can manually attached using **Add Context** > **Instructions** option in the Chat view
   - Stored in the workspace (`.github/instructions`) or user profile

3. One or more `AGENTS.md` files:
   - Define custom instructions for all AI agents in workspace
   - Automatically applies to all chat requests within workspace
   - Stored in the root of the workspace or in subfolders
   - Enabled by setting: `chat.useAgentsMdFile` and `chat.useNestedAgentsMdFiles` (use multiple `AGENTS.md` files)


## Examples

### General coding guidelines

```md
---
applyTo: "**"
description: A short description of the instructions file.
name: The name of the instructions file, used in the UI. If not specified, the file name is used.
---
# Project general coding standards

## Naming Conventions
- Use PascalCase for component names, interfaces, and type aliases
- Use camelCase for variables, functions, and methods
- Prefix private class members with underscore (_)
- Use ALL_CAPS for constants

## Error Handling
- Use try/catch blocks for async operations
- Implement proper error boundaries in React components
- Always log errors with contextual information
```


### Language-specific coding guidelines

The below instruction references the **general coding guidelines** above:

```md
---
applyTo: "**/*.ts,**/*.tsx"
---
# Project coding standards for TypeScript and React

Apply the [general coding guidelines](./instructions.mdx) to all code.

## TypeScript Guidelines
- Use TypeScript for all new code
- Follow functional programming principles where possible
- Use interfaces for data structures and type definitions
- Prefer immutable data (const, readonly)
- Use optional chaining (?.) and nullish coalescing (??) operators

## React Guidelines
- Use functional components with hooks
- Follow the React hooks rules (no conditional hooks)
- Use React.FC type for components with children
- Keep components small and focused
- Use CSS modules for component styling
```


### Documentation writing guidelines

```md
---
applyTo: "docs/**/*.md"
---
# Project documentation writing guidelines

## General Guidelines
- Write clear and concise documentation.
- Use consistent terminology and style.
- Include code examples where applicable.

## Grammar
* Use present tense verbs (is, open) instead of past tense (was, opened).
* Write factual statements and direct commands. Avoid hypotheticals like "could" or "would".
* Use active voice where the subject performs the action.
* Write in second person (you) to speak directly to readers.

## Markdown Guidelines
- Use headings to organize content.
- Use bullet points for lists.
- Include links to related resources.
- Use code blocks for code snippets.
```


### Web application

```md
# Project Overview

This project is a web application that allows users to manage their tasks and to-do lists. It is built using React and Node.js, and uses MongoDB for data storage.

## Folder Structure

- `/src`: Contains the source code for the frontend.
- `/server`: Contains the source code for the Node.js backend.
- `/docs`: Contains documentation for the project, including API specifications and user guides.

## Libraries and Frameworks

- React and Tailwind CSS for the frontend.
- Node.js and Express for the backend.
- MongoDB for data storage.

## Coding Standards

- Use semicolons at the end of each statement.
- Use single quotes for strings.
- Use function based components in React.
- Use arrow functions for callbacks.

## UI guidelines

- A toggle is provided to switch between light and dark mode.
- Application should have a modern and clean design.
```

### Code review

```md
# General Code Review Standards

## Purpose

These instructions guide Copilot code review across all files in this repository.
Language-specific rules are in separate instruction files.

## Security Critical Issues

- Check for hardcoded secrets, API keys, or credentials
- Look for SQL injection and XSS vulnerabilities
- Verify proper input validation and sanitization
- Review authentication and authorization logic

## Performance Red Flags

- Identify N+1 database query problems
- Spot inefficient loops and algorithmic issues
- Check for memory leaks and resource cleanup
- Review caching opportunities for expensive operations

## Code Quality Essentials

- Functions should be focused and appropriately sized (under 50 lines)
- Use clear, descriptive naming conventions
- Ensure proper error handling throughout
- Remove dead code and unused imports

## Review Style

- Be specific and actionable in feedback
- Explain the "why" behind recommendations
- Acknowledge good patterns when you see them
- Ask clarifying questions when code intent is unclear

## Testing Standards

- New features require unit tests
- Tests should cover edge cases and error conditions
- Test names should clearly describe what they test

Always prioritize security vulnerabilities and performance issues that could impact users.
```

### Playwright tests

```md title=".github/instructions/playwright-tests.instructions.md"
---
applyTo: "**/tests/*.spec.ts"
---

## Playwright test requirements

When writing Playwright tests, please follow these guidelines to ensure consistency and maintainability:

1. **Use stable locators** - Prefer `getByRole()`, `getByText()`, and `getByTestId()` over CSS selectors or XPath
1. **Write isolated tests** - Each test should be independent and not rely on other tests' state
1. **Follow naming conventions** - Use descriptive test names and `*.spec.ts` file naming
1. **Implement proper assertions** - Use Playwright's `expect()` with specific matchers like `toHaveText()`, `toBeVisible()`
1. **Leverage auto-wait** - Avoid manual `setTimeout()` and rely on Playwright's built-in waiting mechanisms
1. **Configure cross-browser testing** - Test across Chromium, Firefox, and WebKit browsers
1. **Use Page Object Model** - Organize selectors and actions into reusable page classes for maintainability
1. **Handle dynamic content** - Properly wait for elements to load and handle loading states
1. **Set up proper test data** - Use beforeEach/afterEach hooks for test setup and cleanup
1. **Configure CI/CD integration** - Set up headless mode, screenshots on failure, and parallel execution
```

### Python

````md title=".github/instructions/python.instructions.md"
---
applyTo: "**/*.py"
---

# Python Coding Conventions

## Naming Conventions

- Use snake_case for variables and functions
- Use PascalCase for class names
- Use UPPERCASE for constants

## Code Style

- Follow PEP 8 style guidelines
- Limit line length to 88 characters (Black formatter standard)
- Use type hints for function signatures

## Best Practices

- Use list comprehensions for simple transformations
- Prefer f-strings for string formatting
- Use context managers (with statements) for resource management

```python
# Avoid
file = open('data.txt')
content = file.read()
file.close()

# Prefer
with open('data.txt') as file:
    content = file.read()
```
````

### React

```md title=".github/instructions/frontend.instructions.md"
---
applyTo: "src/components/**/*.{tsx,jsx}"
---

# React Component Guidelines

## Component Structure

- Use functional components with hooks
- Keep components small and focused (under 200 lines)
- Extract reusable logic into custom hooks

## State Management

- Use useState for local component state
- Use useContext for shared state across components
- Avoid prop drilling beyond 2-3 levels

## Accessibility

- All interactive elements must be keyboard accessible
- Include appropriate ARIA labels
- Ensure color contrast meets WCAG AA standards
```


## Specify custom instructions in settings

You can configure custom instructions for specialized scenarios in VS Code settings.

- Code review: `github.copilot.chat.reviewSelection.instructions`
- Commit message generation: `github.copilot.chat.commitMessageGeneration.instructions`
- Pull request title and description generation: `github.copilot.chat.pullRequestDescriptionGeneration.instructions`

```json title=".vscode/settings.json"
{
  "github.copilot.chat.pullRequestDescriptionGeneration.instructions": [
    { "text": "Always include a list of key changes." }
  ],
  "github.copilot.chat.reviewSelection.instructions": [
    { "file": "guidance/backend-review-guidelines.md" },
    { "file": "guidance/frontend-review-guidelines.md" }
  ]
}
```


## Generate instructions files

VS Code can analyze and generate instruction files that match your coding practices and project structure.

In the Chat view, select **Configure Chat** (gear icon) > **Generate Chat Instructions**.


## Sync user instructions

VS Code can sync your user instructions files across multiple devices by using [Settings Sync](https://code.visualstudio.com/docs/copilot/customization/custom-instructions#_sync-user-instructions-files-across-devices).


## Instructions writting tips 

Tips for defining custom instructions:

- Keep them short and self-contained. Each instruction should be a single, simple statement.
- For language-specific instructions, use multiple `*.instructions.md` files per topic, each has corresponding `applyTo` property.
- Store project-specific instructions in your workspace to share them with other team members and include them in your version control.
- Reuse and reference instructions files in your prompt files and custom agents to keep them clean and focused, and to avoid duplicating instructions.


## References

- [Use custom instructions in VS Code](https://code.visualstudio.com/docs/copilot/customization/custom-instructions)
- [Example custom instructions](https://docs.github.com/en/copilot/tutorials/customization-library/custom-instructions/your-first-custom-instructions).
- [Using custom instructions to unlock the power of Copilot code review](https://docs.github.com/en/copilot/tutorials/use-custom-instructions)