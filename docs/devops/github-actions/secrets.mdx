# Secrets

## Levels

Secrets allow you to store sensitive information in different levels:
- [Organization](https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-secrets#creating-secrets-for-an-organization): share secrets between multiple repositories, you can use a [policy](https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-secrets#reviewing-access-to-organization-level-secrets) to limit access by repository
- [Repository](https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-secrets#creating-secrets-for-a-repository): Secrets used only within a single repo. 
- [Environments](https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-secrets#creating-secrets-for-an-environment): Secrets tied to deployment stages (e.g., `DEV`, `STAGING`, `PROD`). You can enable reviewers to approve a job to access a secret

To create secrets or variables for a personal account repository, you must be the repository owner. For an organization repository, you must have `admin` access. If through the REST API, you must have collaborator access.


## Redacting

GitHub Actions automatically redacts GitHub secrets and information that is recognized as sensitive in the workflow logs.


## Using secrets in a workflow

You can use the `secrets` context to access secrets you've created in your repository.

```yml
steps:
  - name: Hello world action
    with: # Set the secret as an input
      super_secret: ${{ secrets.SuperSecret }}
    env: # Or as an environment variable
      super_secret: ${{ secrets.SuperSecret }}
```

Secrets cannot be directly referenced in `if` conditionals. Instead, consider setting secrets as job-level environment variables, then referencing the environment variables to conditionally run steps in the job. 

Avoid passing secrets in command line, if you must do it, enclose them within the proper quoting rules:

```yml
steps:
  - shell: bash
    env:
      SUPER_SECRET: ${{ secrets.SuperSecret }}
    run: |
      example-command "$SUPER_SECRET"
```


## GITHUB_TOKEN

`GITHUB_TOKEN` is a secret that is automatically created at the start of each workflow job.

When you enable GitHub Actions, GitHub installs a GitHub App on your repository. `GITHUB_TOKEN` allows GitHub Actions to authenticate and perform operations on behalf of the GitHub App, without needing to manually create or store a personal access token.

The token is available in `${{ secrets.GITHUB_TOKEN }}` or `${{ github.token }}` context.

`GITHUB_TOKEN` with workflow triggers:
- Events triggered by the job that use `GITHUB_TOKEN` will not create a new workflow run (except for `workflow_dispatch` and `repository_dispatch`).
- Commits pushed by a GitHub Actions workflow that uses the `GITHUB_TOKEN` do not trigger a GitHub Pages build.

For security practice, you should [grant](https://docs.github.com/en/actions/tutorials/authenticate-with-github_token#modifying-the-permissions-for-the-github_token) the `GITHUB_TOKEN` the least required access using the `permissions` key in your workflow file.

If you need a token that requires permissions that aren't [available](https://docs.github.com/en/actions/tutorials/authenticate-with-github_token#granting-additional-permissions) in the GITHUB_TOKEN, create a GitHub App and generate an installation access token within your workflow.


This example workflow creates an issue using the GitHub REST API:

```yml
name: Create issue on commit

on: [ push ]

jobs:
  create_issue:
    runs-on: ubuntu-latest
    permissions:
      issues: write
    steps:
      - name: Create issue using REST API
        run: |
          curl --request POST \
          --url https://api.github.com/repos/${{ github.repository }}/issues \
          --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
          --header 'content-type: application/json' \
          --data '{
            "title": "Automated issue for commit: ${{ github.sha }}",
            "body": "This issue was automatically created by the GitHub Action workflow **${{ github.workflow }}**. \n\n The commit hash was: _${{ github.sha }}_."
            }' \
          --fail
```