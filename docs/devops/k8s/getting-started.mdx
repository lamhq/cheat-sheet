# Getting Started

## Using commands

Create a deployment for a Pod:
```sh
kubectl run nginx-pod --image=nginx:alpine
```

Verify the created pod:
```sh
kubectl get pods
```

Forward a port to allow external access:
```sh
kubectl port-forward nginx-pod 8080:80
```

Access the website at http://localhost:8080/

Delete the Pod (clean up):
```sh
kubectl delete pod nginx-pod
```


## Create a Pod

Create a a Pod that run a web server.

Create the configuration file:

```yml title="pod.yml"
apiVersion: v1
kind: Pod
metadata:
  name: nginx-pod
  labels:
    app: nginx
spec:
  containers:
  - name: nginx-container
    image: nginx:latest
    ports:
    - containerPort: 80
```

Create pod:

```sh
kubectl apply -f pod.yml
```

## Connect to container

By default, a Pod is only accessible by its internal IP address within the Kubernetes cluster. 

To make the container accessible from outside the Kubernetes virtual network, you have to expose the Pod as a Kubernetes Service.

Create an yaml file that define the service:
```yml title="service.yml"
apiVersion: v1
kind: Service
metadata:
  name: nginx-service
spec:
  type: NodePort
  selector:
    app: nginx
  ports:
  - port: 80
    targetPort: 80
    nodePort: 31111
    protocol: TCP
```

Deploy the Service:
```sh
kubectl apply -f service.yml
```

Verify the Service is up and running:
```sh
kubectl get svc
```

Get the URL to access the app:
```sh
minikube service nginx-service --url
```

> [!NOTE]
> The `service` command exposes the `NodePort` service on the host operating system. It creates a tunnel and returns an URL to access the service.

Open the URL from the previous step in the browser to access the app.

## Cleanup

Delete pod:
```sh
kubectl delete pod nginx-pod
```

Delete service:
```sh
kubectl delete service nginx-service
```

Halt the cluster:
```sh
minikube stop
```

Delete all minikube clusters and VMs if you don't need minikube anymore:
```sh
minikube delete --all
```


## References

- https://minikube.sigs.k8s.io/docs/start/
- https://minikube.sigs.k8s.io/docs/handbook/accessing/
