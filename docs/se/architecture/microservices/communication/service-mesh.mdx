# Service Mesh

## Overview

A service mesh is a dedicated infrastructure layer for managing service-to-service communication. It provides common features for service communication, such as mutual TLS, correlation IDs, service discovery, and load balancing.

A service mesh is essentially the sidecar pattern applied at scale across the entire application, specifically for managing service to service communication.


## How it works

A service mesh has two main components:

**Data Plane**:
- Is a network of Sidecar Proxies deployed alongside every microservice instance
- All traffic is intercepted and routed by the proxies. The application just make simple HTTP requests to other services.
- Can perform: load balancing, traffic routing, retries, and encryption, authentication, ...
- A popular options is **Envoy**

**Control Plane**:
- Configures and manages the proxies in the data plane by distributing policies and rules.

![](https://www.koyeb.com/static/images/blog/service-mesh.png)


## Benefits

1. **Simplify application code**. The service mesh offloads complex networking logic from your services into the sidecar proxies
2. **Traffic Management**. Advanced routing (canary releases, A/B testing), load balancing, traffic splitting
3. **Resilience**. Automatic retries, timeouts, and circuit breaking for all inter-service calls, without any application code changes
4. **Security**. Enforces encrypted communication between services (mutual TLS - mTLS) and access control policies
5. **Observability**. Automatically generates detailed metrics, logs, and traces for all network traffic between services


## When to use this pattern

Service meshes aren't for everyone:
- They are primarily designed for Kubernetes
- They introduce extra complexity, if you only have a few microservices (< 5), it may not be necessary or cost-effective.
- Service mesh is not able to work as an intermediary for all calls between microservices (such as message broker).

Organizations with many microservices, especially across different programming languages, should consider service meshes.

Service meshes and API gateways are effective for protocols like REST, SOAP, gRPC, and similar HTTP-based communication methods.
