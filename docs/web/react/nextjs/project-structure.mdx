# Project structure

## Recommended Structure

My recommended structure for a Next.js project:

1. Store application code (including `app`) inside a `src` folder. This separates application code from project configuration files in the root of a project.
2. Store the globally shared application code in the root `app` directory
3. Keep route-specific code (components, hooks, utils, etc.) inside its route segment.
4. Group related route segments base on feature or module with Route Groups

```
my-nextjs-app/
├── .env                        # Default environment variables
├── .env.local                  # Local environment variables
├── .env.production             # Production environment variables
├── .env.development            # Development environment variables
├── next.config.js              # Next.js configuration
├── tsconfig.json               # TypeScript configuration (if using TS)
├── next-env.d.ts               # TypeScript declaration file for Next.js
├── package.json                # Project dependencies and scripts
├── public/                     # Static assets (images, fonts, etc.)
└── src/                        # Application code lives here
    ├── app/                    # App Router root
    │   ├── layout.tsx          # Global layout
    │   ├── error.tsx           # Global error boundary
    │   ├── loading.tsx         # Global loading UI
    │   ├── (auth)/             # Route group: auth feature
    │   │   ├── login/          # `/login` route
    │   │   │   └── page.tsx
    │   │   ├── register/       # `/register` route
    │   │   │   └── page.tsx
    │   │   └── components/     # Auth-specific components
    │   └── (blog)/             # Route group: blog feature
    │       ├── page.tsx        # home route `/`
    │       ├── [slug]/         # Dynamic route: `/:slug`
    │       │   └── page.tsx
    │       ├── components/     # Blog-specific components
    │       └── utils/          # Blog-specific utilities
    ├── components/             # Shared components across the app
    ├── hooks/                  # Shared hooks across the app
    └── lib/                    # Shared utilities
```


## app directory

```
app/
├── layout.tsx            # Layout
├── page.tsx              # Page (route: "/")
├── loading.tsx           # Loading UI
├── not-found.tsx         # Not found UI
├── error.tsx             # Error UI
├── global-error.tsx      # Global error UI
├── route.ts              # API endpoint
├── template.tsx          # Re-rendered layout
├── default.tsx           # Parallel route fallback page
├── about/
│   ├── layout.tsx        # Layout for /about and its children
│   └── page.tsx          # About page (route: "/about")
└── blog/
    ├── page.tsx          # Blog index (route: "/blog")
    └── [slug]/           # Dynamic route (e.g., "/blog/my-post")
        └── page.tsx
```


## Component hierarchy

Components defined in special files (`layout.tsx`, `page.tsx`, `loading.tsx`, ...) are rendered in a specific hierarchy:

![Component Hierarchy for File Conventions](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/file-conventions-component-hierarchy.png)

Components of a route segment will be nested inside the components of its parent segment:

![Nested File Conventions Component Hierarchy](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/nested-file-conventions-component-hierarchy.png)


## How routing works

In the `app` directory. Each folder represents a route segment that is mapped to a corresponding segment in a URL path.

Nested folders define nested routes.

A route is **only publicly accessible** if a `page.js` or `route.js` file exists in a route segment.

![A diagram showing how a route is not publicly accessible until a page.js or route.js file is added to a route segment.](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/project-organization-not-routable.png)

Only the content returned by `page.js` or `route.js` is sent to the client, other components are not.

![A diagram showing colocated project files are not routable even when a segment contains a page.js or route.js file.](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/project-organization-colocation.png)


## Private folders

Private folders can be created by prefixing a folder with an underscore: `_folderName`.

![An example folder structure using private folders](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/project-organization-private-folders.png)

They can be useful for:

- Separating UI logic from routing logic explicitly.
- Consistently organizing internal files across a project and the Next.js ecosystem.
- Sorting and grouping files in code editors.
- Avoiding potential naming conflicts with future Next.js file conventions.

> [!INFO]
> You can create URL segments that start with an underscore by prefixing the folder name with `%5F` (the URL-encoded form of an underscore): `%5FfolderName`.


## Route groups

Route groups are a way to group related routes together without adding an extra segment to the URL.

For example, we want to group `/about` and `/blog` under the `marketing` feature without adding a `marketing` segment to the URL:

![An example folder structure using route groups](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/project-organization-route-groups.png)

Route groups are useful for:

- **Organizing/grouping routes without affecting the URL**
- **Using multiple layouts in a same segment**:
  ![Route Groups with Multiple Layouts](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/route-group-multiple-layouts.png)
  _In this example, even though routes inside `(marketing)` and `(shop)` share the same URL hierarchy, you can create a different layout for each group by adding a `layout.js` file inside their folders._
- **Using the same layout for different segments**:
  ![Route Groups with Opt-in Layouts](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/route-group-opt-in-layouts.png)
  _In this example, the `/account` and `/cart` segments share the same layout `(shop)/layout.js`._
- **Using multiple root layouts**. Remove the top-level `layout.js` file, and add a `layout.js` file inside each route group. This is useful for partitioning an application into sections that have a completely different UI or experience. The `<html>` and `<body>` tags need to be added to each root layout.
  ![Route Groups with Multiple Root Layouts](https://h8DxKfmAPhn8O0p3.public.blob.vercel-storage.com/docs/light/route-group-multiple-root-layouts.png)
