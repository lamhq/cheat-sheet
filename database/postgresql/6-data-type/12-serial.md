# `SERIAL` Types

## Introduction

`SMALLSERIAL`, `SERIAL`, and `BIGSERIAL` are auto-incrementing integers often used as primary keys of tables

Behind the scenes, the following statement:

```sql
CREATE TABLE tablename (
    colname SERIAL
);
```

is equivalent to the following statements:

```sql
CREATE SEQUENCE table_name_id_seq;

CREATE TABLE table_name (
    id integer NOT NULL DEFAULT nextval('table_name_id_seq')
);

ALTER SEQUENCE table_name_id_seq
OWNED BY table_name.id;
```

By assigning the `SERIAL` pseudo-type to the id column, PostgreSQL performs the following:

- First, create a sequence object and set the next value generated by the sequence as the default value for the column.
- Second, add a `NOT NULL` constraint to the id column because a sequence always generates an integer, which is a non-null value.
- Third, assign the owner of the sequence to the `id` column; as a result, the sequence object is deleted when the `id` column or table is dropped


## SERIAL as primary key

`SERIAL` does not implicitly create an index on the column or make the column as the primary key column. However, this can be done easily by specifying the `PRIMARY KEY` constraint for the `SERIAL` column

```sql
CREATE TABLE fruits(
   id SERIAL PRIMARY KEY,
   name VARCHAR NOT NULL
);
```

## Sequence

### Get the sequence name of a `SERIAL` column in a table:

```sql
pg_get_serial_sequence('table_name','column_name')
```

### Get the recent value generated by the sequence:

```sql
SELECT currval(pg_get_serial_sequence('fruits', 'id'));
```

### Get the value generated by the sequence when you insert a new row into the table:

```sql
INSERT INTO fruits(name) VALUES('Banana') RETURNING id;
```


### Using existing sequence for new tables

You can use the same sequence across multiple tables. The cross-table sharing of the same sequence comes in handy when you’re assigning a universal key in your database.

```sql
CREATE SEQUENCE s START 1;
CREATE TABLE stuff(
  id bigint DEFAULT nextval('s') PRIMARY KEY, 
  name text
);
```
